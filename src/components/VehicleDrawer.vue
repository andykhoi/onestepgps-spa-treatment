<script setup>
import { ref, computed } from 'vue'
import { useDraggable } from '@vueuse/core'
import { useStore } from 'vuex'

const el = ref(null)

const store = useStore()

const activeVehicles = computed(() => store.getters.getActiveVehicles)

const { style } = useDraggable(el, {
  initialValue: { x: 0, y: 0 },
  axis: 'y'
})
</script>

<template>
  <div class="drawer" :style="style">
    <div ref="el" class="handle">
      <div class="bar"></div>
    </div>
    <div class="header">
      <div className="onestep-logo">
        <svg
          width="158"
          height="28"
          viewBox="0 0 158 28"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M37.6842 15.3814V23.3467H33.2638V16.0279C33.2638 14.8653 32.466 14.1138 31.3863 14.1138C30.3065 14.1138 29.5369 14.8625 29.5369 16.0279V23.3467H25.1165V10.419H29.1535V11.4795C30.0274 10.6515 31.2622 10.1099 32.7789 10.1099C35.7841 10.1071 37.6842 12.1998 37.6842 15.3814ZM52.5438 18.4322H44.3176C44.8053 19.4417 45.8089 19.9068 47.1959 19.9068C48.4307 19.9068 49.5104 19.5438 50.5648 18.8973L52.1576 21.9229C50.6155 23.0855 48.9184 23.6555 47.0409 23.6555C42.7981 23.6555 39.8183 20.7348 39.8183 16.8811C39.8183 13.0275 42.8263 10.1068 46.6828 10.1068C50.4887 10.1068 52.8257 12.9509 52.8257 16.2346C52.8257 17.0088 52.6989 17.8623 52.5438 18.4322ZM44.1625 15.5371H48.6365C48.5857 14.3489 47.6329 13.5975 46.5024 13.5975C45.4227 13.5975 44.5234 14.295 44.1625 15.5371ZM66.7071 9.40951L63.7498 11.6837C62.9774 10.5466 62.2331 9.87456 60.9476 9.87456C60.0737 9.87456 59.4309 10.1836 59.4309 10.9606C59.4309 11.6071 59.8425 11.9162 60.8969 12.3557L62.8505 13.1838C65.6781 14.3719 67.1948 15.8209 67.1948 18.3304C67.1948 21.6907 64.4687 23.6558 60.973 23.6558C57.8635 23.6558 55.4193 22.1302 54.2127 19.8277L57.1954 17.5535C58.0185 18.6651 59.0729 19.7511 60.973 19.7511C62.1542 19.7511 62.7208 19.3371 62.7208 18.5091C62.7208 17.7066 62.1796 17.4486 60.9984 16.9325L59.2505 16.1555C56.5526 14.9645 54.957 13.4134 54.957 11.0088C54.957 7.95766 57.4491 5.96704 60.8941 5.96704C63.8541 5.96987 65.7317 7.44157 66.7071 9.40951ZM78.3529 19.6204V23.3436C77.5027 23.5497 76.6311 23.6534 75.7565 23.6527C72.1847 23.6527 70.1013 21.9201 70.1013 18.4039V14.1391H68.1477V10.4159H70.1013V7.31368H74.5217V10.4159H77.9667V14.1391H74.5217V17.9672C74.5217 19.1837 75.1137 19.6743 76.7319 19.6743C77.0928 19.6743 77.6594 19.6459 78.3529 19.6204ZM92.4401 18.4322H84.2139C84.7016 19.4417 85.7052 19.9068 87.0922 19.9068C88.327 19.9068 89.4067 19.5438 90.4611 18.8973L92.0539 21.9229C90.5118 23.0855 88.8147 23.6555 86.9371 23.6555C82.6944 23.6555 79.7145 20.7348 79.7145 16.8811C79.7145 13.0275 82.7226 10.1068 86.5791 10.1068C90.3849 10.1068 92.722 12.9509 92.722 16.2346C92.722 17.0088 92.5951 17.8623 92.4401 18.4322ZM84.0588 15.5371H88.5328C88.482 14.3489 87.5292 13.5975 86.3987 13.5975C85.319 13.5975 84.4197 14.295 84.0588 15.5371ZM108.842 16.8556C108.842 20.8114 106.271 23.6555 102.674 23.6555C101.287 23.6555 100.179 23.216 99.3836 22.4674V27.9997H94.9632V10.4159H99.0002V11.76C99.798 10.6739 101.03 10.104 102.676 10.104C106.271 10.1068 108.842 12.8971 108.842 16.8556ZM104.317 16.8811C104.317 15.072 103.108 14.1391 101.797 14.1391C100.562 14.1391 99.3018 14.9671 99.3018 16.8556C99.3018 18.7186 100.537 19.6232 101.797 19.6232C103.082 19.6204 104.317 18.6903 104.317 16.8811Z"
            fill="#002E6D"
          />
          <path
            d="M126.988 9.76935L123.904 12.4065C122.85 10.932 121.539 10.0529 119.611 10.0529C116.732 10.0529 114.985 11.9925 114.985 14.8111C114.985 17.7063 116.837 19.6969 119.87 19.6969C121.491 19.6969 122.774 19.127 123.597 18.1714V17.3689H119.639V13.5408H128.02V18.92C126.504 21.6337 123.47 23.6527 119.693 23.6527C114.5 23.6527 110.463 19.8529 110.463 14.8083C110.463 9.79204 114.472 5.96392 119.693 5.96392C122.825 5.96959 125.345 7.33921 126.988 9.76935ZM143.751 12.1487C143.751 15.6905 140.923 18.044 137.197 18.044H134.961V23.3439H130.538V6.27896H137.197C140.923 6.27896 143.751 8.52762 143.751 12.1487ZM134.958 10.1581V14.1649H137.219C138.454 14.1649 139.249 13.3624 139.249 12.1487C139.249 10.9578 138.451 10.1581 137.219 10.1581H134.958ZM157.401 9.40951L154.444 11.6837C153.672 10.5466 152.927 9.87455 151.642 9.87455C150.768 9.87455 150.125 10.1836 150.125 10.9606C150.125 11.6071 150.537 11.9162 151.591 12.3557L153.545 13.1838C156.372 14.3719 157.889 15.8209 157.889 18.3304C157.889 21.6907 155.163 23.6558 151.667 23.6558C148.558 23.6558 146.113 22.1302 144.907 19.8277L147.889 17.5535C148.713 18.6651 149.767 19.7511 151.667 19.7511C152.851 19.7511 153.415 19.3371 153.415 18.5091C153.415 17.7066 152.874 17.4486 151.693 16.9325L149.945 16.1555C147.247 14.9645 145.651 13.4134 145.651 11.0088C145.651 7.95766 148.146 5.96704 151.588 5.96704C154.545 5.96987 156.423 7.44157 157.401 9.40951ZM3.86875 9.52293C3.74403 9.52268 3.6216 9.48917 3.51395 9.42582C3.40631 9.36247 3.31728 9.27153 3.25596 9.16229C3.19464 9.05305 3.16321 8.92941 3.16488 8.80397C3.16654 8.67853 3.20125 8.55578 3.26545 8.44823C4.81316 5.87062 7.23479 3.97925 10.0906 3.11721C10.4627 3.00379 10.8574 3.2193 10.9673 3.5936C11.0801 3.96791 10.8658 4.3649 10.4937 4.47549C7.97622 5.23261 5.8365 6.90564 4.47204 9.17982C4.33954 9.401 4.10837 9.52293 3.86875 9.52293Z"
            fill="#1BA6FF"
          />
          <path
            d="M0.703028 9.57973C0.585411 9.57935 0.469757 9.54937 0.366608 9.49252C0.263459 9.43568 0.176095 9.35376 0.112478 9.25426C0.0488605 9.15475 0.0110138 9.04081 0.00238682 8.92282C-0.00624018 8.80483 0.0146268 8.68655 0.0630861 8.57875C0.305531 8.03997 0.581806 7.50971 0.886271 7.00213C2.792 3.82621 5.77746 1.49531 9.29573 0.434776C9.89338 0.253295 10.5136 0.111513 11.131 0.00942967C11.5144 -0.0529545 11.8781 0.207925 11.9401 0.593572C12.0021 0.97922 11.7427 1.34502 11.3593 1.4074C10.7983 1.50098 10.2401 1.62858 9.69886 1.79305C6.51889 2.7515 3.81534 4.86122 2.09286 7.73372C1.81658 8.1931 1.5685 8.67232 1.34861 9.16005C1.29208 9.28471 1.20124 9.39048 1.08683 9.46485C0.972429 9.53922 0.839244 9.57909 0.703028 9.57973ZM9.55509 14.9246L12.3517 16.1298L13.5526 18.9456L16.5606 11.9047L9.55509 14.9246Z"
            fill="#1BA6FF"
          />
          <path
            d="M13.6568 5.82809C8.72611 5.82809 4.7314 9.84903 4.7314 14.8057C4.7314 19.7653 8.72892 23.7834 13.6568 23.7834C18.5846 23.7834 22.5821 19.7624 22.5821 14.8057C22.5821 9.8462 18.5874 5.82809 13.6568 5.82809ZM14.0627 19.1216L13.5525 20.3154L13.0309 19.0904C11.1562 18.8153 9.67615 17.3295 9.39988 15.4438L8.19329 14.922L9.36887 14.4144C9.56339 12.2026 11.4099 10.4672 13.6596 10.4672C14.6716 10.4672 15.602 10.8217 16.3377 11.4115L17.5894 10.8727L17.051 12.1346C17.6473 12.8956 17.9711 13.8367 17.97 14.8057C17.9672 17.0629 16.2532 18.9174 14.0627 19.1216Z"
            fill="#002E6D"
          />
        </svg>
      </div>
      <div class="active-vehicle-count">
        {{ activeVehicles.length }}
        <svg
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M0 12C0 5.37258 5.37258 0 12 0C18.6274 0 24 5.37258 24 12C24 18.6274 18.6274 24 12 24C5.37258 24 0 18.6274 0 12Z"
            fill="#616161"
          />
          <path
            d="M17.6538 10.7885H17.1087L15.7063 7.63341C15.6428 7.49067 15.5393 7.36939 15.4083 7.28427C15.2774 7.19915 15.1245 7.15385 14.9683 7.15385H9.03173C8.87551 7.15385 8.72265 7.19915 8.59166 7.28427C8.46066 7.36939 8.35717 7.49067 8.2937 7.63341L6.89135 10.7885H6.34615C6.23905 10.7885 6.13633 10.831 6.06059 10.9067C5.98486 10.9825 5.94231 11.0852 5.94231 11.1923C5.94231 11.2994 5.98486 11.4021 6.06059 11.4779C6.13633 11.5536 6.23905 11.5962 6.34615 11.5962H6.75V15.6346C6.75 15.8488 6.8351 16.0543 6.98657 16.2057C7.13804 16.3572 7.34348 16.4423 7.55769 16.4423H8.76923C8.98344 16.4423 9.18888 16.3572 9.34035 16.2057C9.49183 16.0543 9.57692 15.8488 9.57692 15.6346V15.2308H14.4231V15.6346C14.4231 15.8488 14.5082 16.0543 14.6596 16.2057C14.8111 16.3572 15.0166 16.4423 15.2308 16.4423H16.4423C16.6565 16.4423 16.862 16.3572 17.0134 16.2057C17.1649 16.0543 17.25 15.8488 17.25 15.6346V11.5962H17.6538C17.761 11.5962 17.8637 11.5536 17.9394 11.4779C18.0151 11.4021 18.0577 11.2994 18.0577 11.1923C18.0577 11.0852 18.0151 10.9825 17.9394 10.9067C17.8637 10.831 17.761 10.7885 17.6538 10.7885ZM7.77526 10.7885L9.03173 7.96154H14.9683L16.2247 10.7885H7.77526Z"
            fill="white"
          />
          <path
            d="M0 12C0 5.37258 5.37258 0 12 0C18.6274 0 24 5.37258 24 12C24 18.6274 18.6274 24 12 24C5.37258 24 0 18.6274 0 12Z"
            stroke="white"
          />
          <path
            d="M17.6538 10.7885H17.1087L15.7063 7.63341C15.6428 7.49067 15.5393 7.36939 15.4083 7.28427C15.2774 7.19915 15.1245 7.15385 14.9683 7.15385H9.03173C8.87551 7.15385 8.72265 7.19915 8.59166 7.28427C8.46066 7.36939 8.35717 7.49067 8.2937 7.63341L6.89135 10.7885H6.34615C6.23905 10.7885 6.13633 10.831 6.06059 10.9067C5.98486 10.9825 5.94231 11.0852 5.94231 11.1923C5.94231 11.2994 5.98486 11.4021 6.06059 11.4779C6.13633 11.5536 6.23905 11.5962 6.34615 11.5962H6.75V15.6346C6.75 15.8488 6.8351 16.0543 6.98657 16.2057C7.13804 16.3572 7.34348 16.4423 7.55769 16.4423H8.76923C8.98344 16.4423 9.18888 16.3572 9.34035 16.2057C9.49183 16.0543 9.57692 15.8488 9.57692 15.6346V15.2308H14.4231V15.6346C14.4231 15.8488 14.5082 16.0543 14.6596 16.2057C14.8111 16.3572 15.0166 16.4423 15.2308 16.4423H16.4423C16.6565 16.4423 16.862 16.3572 17.0134 16.2057C17.1649 16.0543 17.25 15.8488 17.25 15.6346V11.5962H17.6538C17.761 11.5962 17.8637 11.5536 17.9394 11.4779C18.0151 11.4021 18.0577 11.2994 18.0577 11.1923C18.0577 11.0852 18.0151 10.9825 17.9394 10.9067C17.8637 10.831 17.761 10.7885 17.6538 10.7885ZM7.77526 10.7885L9.03173 7.96154H14.9683L16.2247 10.7885H7.77526Z"
            stroke="white"
          />
        </svg>
      </div>
    </div>
    <div :key="vehicle.vin" v-for="vehicle in activeVehicles">
      <div class="active-vehicle">
        <div class="vehicle-icon">
          <div v-if="vehicle.driver === ''">
            <svg
              width="28"
              height="28"
              viewBox="0 0 28 28"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M26.25 11.375H25.0687L22.0303 4.53906C21.8928 4.22978 21.6686 3.96701 21.3847 3.78259C21.1009 3.59816 20.7697 3.5 20.4313 3.5H7.56875C7.23028 3.5 6.89907 3.59816 6.61525 3.78259C6.33144 3.96701 6.10719 4.22978 5.96969 4.53906L2.93125 11.375H1.75C1.51794 11.375 1.29538 11.4672 1.13128 11.6313C0.967187 11.7954 0.875 12.0179 0.875 12.25C0.875 12.4821 0.967187 12.7046 1.13128 12.8687C1.29538 13.0328 1.51794 13.125 1.75 13.125H2.625V21.875C2.625 22.3391 2.80937 22.7842 3.13756 23.1124C3.46575 23.4406 3.91087 23.625 4.375 23.625H7C7.46413 23.625 7.90925 23.4406 8.23744 23.1124C8.56563 22.7842 8.75 22.3391 8.75 21.875V21H19.25V21.875C19.25 22.3391 19.4344 22.7842 19.7626 23.1124C20.0908 23.4406 20.5359 23.625 21 23.625H23.625C24.0891 23.625 24.5342 23.4406 24.8624 23.1124C25.1906 22.7842 25.375 22.3391 25.375 21.875V13.125H26.25C26.4821 13.125 26.7046 13.0328 26.8687 12.8687C27.0328 12.7046 27.125 12.4821 27.125 12.25C27.125 12.0179 27.0328 11.7954 26.8687 11.6313C26.7046 11.4672 26.4821 11.375 26.25 11.375ZM4.84641 11.375L7.56875 5.25H20.4313L23.1536 11.375H4.84641Z"
                fill="white"
              />
            </svg>
          </div>
          <div v-else class="driver-initials">
            {{ vehicle.driver.substring(0, 1) }}
            {{
              vehicle.driver.substring(
                vehicle.driver.indexOf(' ') + 1,
                vehicle.driver.indexOf(' ') + 2
              )
            }}
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<style scoped>
.drawer {
  width: 100%;
  height: 100%;
  /* height: 200px; */
  background-color: #f5f5f5;
  position: fixed;
  border-top-right-radius: 30px;
  border-top-left-radius: 30px;
  padding: 0px 28px;
  color: #000000;
}
.handle {
  padding: 12px;
}
.bar {
  margin: 0 auto;
  width: 100px;
  height: 4px;
  border-radius: 4px;
  background-color: #d9d9d9;
}

.active-vehicle-count {
  display: flex;
  gap: 8px;
}
.header {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.vehicle-icon {
  width: 48px;
  height: 48px;
  background-color: #002e6d;
  border-radius: 24px;
  display: flex;
  justify-content: center;
  align-items: center;
}

.driver-initials {
  color: white;
}
</style>
